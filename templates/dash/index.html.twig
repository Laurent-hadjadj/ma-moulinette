{% set title = 'Suivi des versions' %}
{% set description = 'Ma Moulinette - Suivi des versions.' %}
<!DOCTYPE html>
<html  lang="fr">

{# Chargement de la section HEAD #}
<head>
  {{ include('head.html.twig') }}
  {% block stylesheets %}
     {{ encore_entry_link_tags('dash') }}
  {% endblock %}
</head>

<body>
{# Chargement de la section header #}
{{ include('header.html.twig') }}
<br />

<header class="grid-container">
	<nav aria-label="Ici : " role="navigation">
		<ul class="claire-hand breadcrumbs">
      <li><a href="/">Accueil</a></li>
      <li><a href="/projet">Projet</a></li>
      <li><span class="show-for-sr">Current:</span>Suivi</li></ul>
	</nav>
</header>

<div class="pleine-page">
  <h2 id="js-nom" class="claire-hand" data-maven="{{maven_key}}">{{nom}}</h2>
  {# Suivi des anomalie #}
  <div class="cell">
    <h4 class="claire-hand"><span id="affiche-total-profil" class="stat">
      {% set nombre=dash|length %}
      {% if nombre>1 %} {% set s="s"%} {% else %} {% set s="" %} {% endif %}
      {{nombre}}</span> version{{s}} trouvé{{s}}.
    </h4>

    <div class="table-scroll">
      <table>
        <caption class="claire-hand">Suivi des Anomalies.</caption>
        <thead>
          <tr>
            <th scope="col"></th>
            {% for i in 0..dash|length-1 %}
            {% if dash[i]["initial"]==1 %} {% set reference="reference" %} {% else %} {% set reference="null" %} {% endif %}
            <th scope="col" class="open-sans text-right {{reference}}">{{dash[i]["version"]}}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody id="tableau-liste-profil" class="open-sans">
          <tr class="open-sans">
          <td class="text-left">Fiabilité</td>
          {% for i in 0..dash|length-1 %}
              <td class="text-right"><span>{{dash[i]["bug"]|format_number(locale='fr')}}
                {% if dash[i]["fiabilite"]=="A" %} {% set couleur="vert1" %}{% endif %}
                {% if dash[i]["fiabilite"]=="B" %} {% set couleur="vert2" %}{% endif %}
                {% if dash[i]["fiabilite"]=="C" %} {% set couleur="jaune" %}{% endif %}
                {% if dash[i]["fiabilite"]=="D" %} {% set couleur="orange" %}{% endif %}
                {% if dash[i]["fiabilite"]=="E" %} {% set couleur="rouge" %}{% endif %}
                <span class="{{couleur}}">{{dash[i]["fiabilite"]}}</span>
              </td>
          {% endfor %}
          </tr>
          <tr class="open-sans">
          <td class="text-left">Sécurité</td>
          {% for i in 0..dash|length-1 %}
              <td class="text-right">
                <span>{{dash[i]["faille"]|format_number(locale='fr')}}</span>
                {% if dash[i]["securite"]=="A" %} {% set couleur="vert1" %}{% endif %}
                {% if dash[i]["securite"]=="B" %} {% set couleur="vert2" %}{% endif %}
                {% if dash[i]["securite"]=="C" %} {% set couleur="jaune" %}{% endif %}
                {% if dash[i]["securite"]=="D" %} {% set couleur="orange" %}{% endif %}
                {% if dash[i]["securite"]=="E" %} {% set couleur="rouge" %}{% endif %}
                <span class="{{couleur}}">{{dash[i]["securite"]}}</span>
              </td>
          {% endfor %}
          </tr>
          <tr class="open-sans">
          <td class="text-left">Hotspot</td>
          {% for i in 0..dash|length-1 %}
              <td class="text-right">
                <span>{{dash[i]["nombre_hotspot"]|format_number(locale='fr')}}</span>
                {% if dash[i]["note_hotspot"]=="A" %} {% set couleur="vert1" %}{% endif %}
                {% if dash[i]["note_hotspot"]=="B" %} {% set couleur="vert2" %}{% endif %}
                {% if dash[i]["note_hotspot"]=="C" %} {% set couleur="jaune" %}{% endif %}
                {% if dash[i]["note_hotspot"]=="D" %} {% set couleur="orange" %}{% endif %}
                {% if dash[i]["note_hotspot"]=="E" %} {% set couleur="rouge" %}{% endif %}
                <span class="{{couleur}}">{{dash[i]["note_hotspot"]}}</span>
              </td>
          {% endfor %}
          </tr>
          <tr class="open-sans">
          <td class="text-left">Maintenailité</td>
          {% for i in 0..dash|length-1 %}
              <td class="text-right">
                <span>{{dash[i]["mauvaise_pratique"]|format_number(locale='fr')}}</span>
                {% if dash[i]["maintenabilite"]=="A" %} {% set couleur="vert1" %}{% endif %}
                {% if dash[i]["maintenabilite"]=="B" %} {% set couleur="vert2" %}{% endif %}
                {% if dash[i]["maintenabilite"]=="C" %} {% set couleur="jaune" %}{% endif %}
                {% if dash[i]["maintenabilite"]=="D" %} {% set couleur="orange" %}{% endif %}
                {% if dash[i]["maintenabilite"]=="E" %} {% set couleur="rouge" %}{% endif %}
                <span class="{{couleur}}">{{dash[i]["maintenabilite"]}}</span>
              </td>
          {% endfor %}
          </tr>
          <tr class="open-sans">
          <td class="text-left">SupressWarning</td>
          {% for i in 0..dash|length-1 %}
              <td class="text-right">{{dash[i]["suppress_warning"]|format_number(locale='fr')}}</td>
          {% endfor %}
          </tr>
          <tr class="open-sans">
          <td class="text-left">No Sonar</td>
          {% for i in 0..dash|length-1 %}
              <td class="text-right">{{dash[i]["no_sonar"]|format_number(locale='fr')}}</td>
          {% endfor %}
          </tr>
        </tbody>
      </table>
    </div>
    {# Ajouter une analyse #}
    <div>
      <p class="js-ajouter-analyse open-sans">
        <svg version="1.0" xmlns="http://www.w3.org/2000/svg"  viewbox="0 0 512 512" class="ajouter-analyse-svg">
          <path d="M19 2.9c-1.9 1-4.5 3.3-5.7 5.1L11 11.3v371.4l2.2 3.3c4.9 7.1 4.1 7 53.9 7h44.6l1.7 9.2c4.9 26.5 18.5 52.1 38 71.3 17.7 17.4 37.1 28.4 62.6 35.3 8.9 2.5 10.8 2.6 32.5 2.6s23.5-.1 32.6-2.6c52.1-14.2 89.4-53.3 99.9-104.8 1.1-5.4 2-10.1 2-10.4 0-.3 9.5-.6 21-.6 23.1 0 24.6-.3 29.3-5.9 3.6-4.3 69.7-202.7 69.7-209.2 0-5.6-2.9-10.4-8-13-3.1-1.7-6-1.9-24.7-1.9h-21.2l-.3-39.3-.3-39.2-2.3-3.3c-5.1-7.1 1.9-6.6-104-7.2l-95.2-.5-26.3-34c-14.5-18.7-27.8-35-29.7-36.3L185.7 1h-81.6C26.6 1 22.3 1.1 19 2.9zm443.8 193.3c-.3.7-12.8 38.1-27.8 83L407.7 361h-13.4c-7.3 0-13.3-.2-13.3-.4s-.7-4.1-1.6-8.6c-5-26.4-17.8-50.4-37.4-70.1-27.5-27.6-62.1-41.2-101-39.6-35.5 1.5-64.8 14.4-90.1 39.6-19.9 20-32.2 43-37.4 69.9l-1.8 9.2H80.9c-24.2 0-30.7-.3-30.4-1.3.2-.6 9-34.5 19.5-75.2s20-77.5 21.2-81.8l2-7.7h185c147.6 0 184.9.3 184.6 1.2zM255.3 303.5c6.5 4.5 6.7 5.5 6.7 32.9v24.5l24.8.3c22.8.3 25 .5 28.2 2.4 10.1 5.9 10.4 19.5.6 26.8-2.6 2-4.5 2.1-27.9 2.6l-25.2.5-.5 25.7-.5 25.7-3 3.2c-3.4 3.6-8.2 5.9-12.2 5.9-4.4 0-11-3.8-13.5-7.8-2.2-3.6-2.3-4.7-2.6-28.5l-.4-24.7h-24c-22.5 0-24.3-.1-27.7-2.1-5.8-3.3-7.6-6.5-7.6-13.6 0-7.4 2-10.7 8.5-14.1 4.2-2.1 5.5-2.2 27.6-2.2h23.3l.3-24.3c.3-22.3.5-24.5 2.4-27.7 4.7-8.1 15.1-10.6 22.7-5.5z"/>
        </svg>
        <span class="lien-ajouter">Ajouter une analyse.</span>
      </p>
    </div>

    {# Affiche le graphique #}
    <canvas class="show-for-medium" id="graphique-anomalie" width="400" height="100"
    data-data1="{{data1}}" data-data2="{{data2}}" data-data3="{{data3}}"
    data-label="{{labels}}"></canvas>

    {# Affiche le tableau de répartition par module #}
    <div class="table-scroll">
      <table>
        <caption class="claire-hand">Répartition par module.</caption>
        <thead>
          <tr>
            <th></th>
            {% for i in 0..dash|length-1 %}
            {% if dash[i]["initial"]==1 %} {% set reference="reference" %} {% else %} {% set reference="null" %} {% endif %}
            <th class="open-sans text-center {{refrence}}">{{dash[i]["version"]}}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody id="tableau-module" class="open-sans">
          <tr >
            <td class="text-left">Présentation</td>
            {% for i in 0..dash|length-1 %}
              <td class="text-center">{{dash[i]["presentation"]|format_number(locale='fr')}}</td>
            {% endfor %}
          </tr>
          <tr>
            <td class="text-left">Métier</td>
            {% for i in 0..dash|length-1 %}
            <td class="text-center">{{dash[i]["metier"]|format_number(locale='fr')}}</td>
            {% endfor %}
          </tr>
          <tr>
            <td class="text-left">Batch</td>
            {% for i in 0..dash|length-1 %}
              <td class="text-center">{{dash[i]["batch"]|format_number(locale='fr')}}</td>
            {% endfor %}
          </tr>
        </tbody>
      </table>
    </div>

    <div class="table-scroll">
      <table class="hover ">
        <caption class="claire-hand">Tableau des anomalies par sévérité.</caption>
        <thead>
          <tr>
            <th></th>
            {% for i in 0..dash|length-1 %}
            {% if dash[i]["initial"]==1 %} {% set reference="reference" %} {% else %} {% set reference="null" %} {% endif %}
            <th class="open-sans text-center {{refence}}">{{dash[i]["version"]}}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody id="tableau-anomalie-severite" class="open-sans">
          <tr>
            <td class="text-left">Bloquant</td>
            {% for i in 0..severite|length-1 %}
             {% set lookup="null" %}
             {% if i >0 %}
              {% if severite[i]["bloquant"] > severite[i-1]["bloquant"] and
                    severite[i]["bloquant"] != severite[i-1]["bloquant"] %}
                    {% set lookup = "up" %} {% else %} {% set lookup = "down" %}
              {% endif %}
              {% if severite[i]["bloquant"] ==0 %} {% set lookup = "null" %} {% endif %}
             {% endif %}
              <td class="text-right">{{severite[i]["bloquant"]|format_number(locale='fr')}} <span class="{{lookup}}"></span></td>
            {% endfor %}
          </tr>
          <tr>
            <td class="text-left">Critique</td>
            {% for i in 0..severite|length-1 %}
             {% set lookup = "null" %}
             {% if i >0 %}
              {% if severite[i]["critique"] > severite[i-1]["critique"] and
                    severite[i]["critique"] != severite[i-1]["critique"] %}
                    {% set lookup = "up" %} {% else %} {% set lookup = "down" %}
              {% endif %}
              {% if severite[i]["critique"] ==0 %} {% set lookup = "null" %} {% endif %}
             {% endif %}
              <td class="text-right">{{severite[i]["critique"]|format_number(locale='fr')}} <span class="{{lookup}}"></span></td>
            {% endfor %}
          </tr>
          <tr>
            <td class="text-left">Majeur</td>
            {% for i in 0..severite|length-1 %}
             {% set lookup="null" %}
             {% if i >0 %}
              {% if severite[i]["majeur"] > severite[i-1]["majeur"] and
                    severite[i]["majeur"] != severite[i-1]["majeur"] %}
                    {% set lookup = "up" %} {% else %} {% set lookup = "down" %}
              {% endif %}
              {% if severite[i]["majeur"] ==0 %} {% set lookup = "null" %} {% endif %}
             {% endif %}

              <td class="text-right">{{severite[i]["majeur"]|format_number(locale='fr')}} <span class="{{lookup}}"></span></td>
            {% endfor %}
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

{#-- fenêtre modale --#}
{# Affichage de la répartition des versions #}
<div id="modal-ajouter-analyse" class="reveal large" data-reveal data-close-on-click="true" data-animation-in="fade-in" data-animation-out="fade-out">
	<h2 class="claire-hand">Ajouter une version.</h2>
	<br/>
  <div class="grid-x cell">
    <div class="small-12 medium-12 large-12 cell">
      <h4>Liste des versions disponibles.</h4>
       <select id="liste-version" class="js-version open-class" name="version">
         <option></option>
       </select>
    </div>
  </div>
  <br />
  {# Formulaire #}
  <div class="fieldset cell">
    <div class="grid-x">
      <div class="small-12 medium-7 large-7 cell">
        <p class="open-sans ligne">Clé maven : <span id="key-maven" class="resultat"></span></p>
        <p class="open-sans ligne">nom : <span id="nom" class="resultat"></span></p>
        <p class="open-sans ligne">Version : <span id="version" class="resultat"></span></p>
        <p class="open-sans ligne">Date : <span id="date" class="resultat"></span></p>
      </div>
      <div class="small-12 medium-5 large-5 cell">
        <p class="open-sans ligne">Fiabilité : <span id="bug" class="resultat"></span>
         <span id="note-reliability" class="resultat-note"></span></p>
        <p class="open-sans ligne">Securité : <span id="vulnerabilities" class="resultat"></span> <span id="note-security" class="resultat-note"></span></p>
        <p class="open-sans ligne">Hotspot : <span  id="hotspots-review" class="resultat"></span> <span id="note-hotspots-review" class="resultat-note"></span></p>
        <p class="open-sans ligne">Maintenabilité : <span id="code-smell" class="resultat"></span> <span id="note-sqale" class="resultat-note"></span></p>
      </div>
    </div>
  </div>

  <div class="fieldset cell">
    <div class="grid-x">
      <div class="small-12 medium-6 large-6 cell">
        <p class="open-sans ligne">Ligne : <span id="lines" class="resultat">
        </span></p>
        <p class="open-sans ligne">NcLoc : <span id="ncloc" class="resultat">
        </span></p>
        <p class="open-sans ligne">Dette (j/h): <span id="dette" class="resultat">
        </span></p>
      </div>
      <div class="small-12 medium-6 large-6 cell">
        <p class="open-sans ligne">Duplication : <span id="duplication" class="resultat">
        </span></p>
        <p class="open-sans ligne">Couverture : <span id="coverage" class="resultat">
        </span></p>
        <p class="open-sans ligne">Tests : <span id="tests" class="resultat">
        </span></p>
      </div>
    </div>
  </div>

  <div class="fieldset cell">
    <form>
      <div class="grid-x grid-padding-x">
        <div class="medium-6 cell">
          <label class="open-sans">Bloquant <input id="bloquant" type="number" min="0" placeholder="Bloquant"> </label>
          <label class="open-sans">Critique <input id="critique" type="number" min="0" placeholder="Critique"> </label>
          <label class="open-sans">Majeure <input id="majeur" type="number" min="0" placeholder="Majeur"> </label>
        </div>
        <div class="medium-6 cell">
          <label class="open-sans">Mineure <input id="mineur" type="number" min="0" placeholder="Mineur"> </label>
          <label class="open-sans">Info <input id="info" type="number" min="0" placeholder="Info"> </label>
        </div>
      </div>
    </form>
   </div>

  <p class="open-sans">Statut : <span class="info">Je dors...</span></p>

  {# Ajouter une analyse #}
  <div class="grid-x cell">
    <div class="small-12 medium-6 large-6 cell">
      <div class="switch ligne">
      <p class="open-sans">Définir comme version de référence ?&nbsp; </p><span> </span>
        <input class="switch-input" id="switch" type="checkbox" name="switch">
          <label class="switch-paddle" for="switch">
            <span class="show-for-sr">Définir comme version de référence ?</span>
            <span class="switch-active" aria-hidden="true">Oui</span>
            <span class="switch-inactive" aria-hidden="true">Non</span>
        </label>
      </div>
    </div>
    <div class="small-12 medium-6 large-6 cell">
      <div class="button expanded float-center js-enregistrer-analyse enregistrer-analyse">
        <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" class="enregistrer-analyse-svg">
          <path d="M168.6 1.6c-17.2 4.2-33.3 19.4-38.2 36.1l-1.5 5.3h-18.2c-15.3 0-18.6.3-20.6 1.6C86.9 46.9 85 52 85 58.5V64H66.3C38.4 64 28.9 67.1 16 80 8.6 87.4 3.7 95.8 1.5 105.1c-2.2 9.7-2.2 292.1 0 301.8C5 421.7 16.3 435.8 30 442.2c4.1 2 9.9 4.1 12.8 4.7 3.6.7 30.7 1.1 83.8 1.1 71.5 0 78.8-.1 81.4-1.7 5.5-3.2 6.7-11.2 2.6-16l-2.4-2.8-80.9-.5-80.8-.5-6.7-3.3c-7.6-3.7-12-8.2-15.7-16.2l-2.6-5.5v-291l3.3-6.7c3.7-7.6 8.2-12 16.2-15.7 5.2-2.5 6.5-2.6 24.8-2.9l19.2-.4v6.1c0 12.9 3.4 21.5 11.2 28.8 8.9 8.2 5.1 7.8 85.8 7.8h71.5l5.7-2.8c6.2-3.1 11.6-8.4 14.9-14.9 1.7-3.3 2.4-6.7 2.8-14.3l.6-10H297c19 0 19.6.1 25.1 2.6 6.9 3.3 12.7 8.9 16 15.5 2.4 4.9 2.4 5.2 2.9 42.9.5 41 .6 41.2 6 44 3.7 1.9 6.3 1.9 10.1-.1 5.6-2.8 5.9-5 5.9-41.1 0-38.4-.6-43.9-5.9-54.8-6.4-13.4-15.8-22-29.7-27.3-6.5-2.4-8.2-2.6-28.6-3l-21.8-.4v-7.3c0-6.4-.3-7.8-2.4-10.2l-2.4-2.8-19.3-.5-19.2-.5-1.2-4.1C224.6 11.5 195.9-5 168.6 1.6zm26 22.8c10.2 4.7 16.9 14.2 18.4 26 1.6 12.8 3.1 13.6 26 13.6h17v17c0 19.3-.8 22.2-6.5 24.6-5 2.1-130.9 2.1-135.9 0-6.2-2.6-6.6-4-6.6-23.8V64h17.1c22.3 0 23.8-.8 25.4-13.5 1.3-10.2 7.2-19.5 15.3-24.2 9.8-5.8 19.9-6.4 29.8-1.9z"/>
          <path d="M69.3 172.2c-5.7 2.8-6.7 12.2-1.7 16.9l2.6 2.4 109.9.3c122.3.3 114.5.7 117.5-6.5 1.9-4.3.5-9.3-3.3-12.3-2.5-2-3.7-2-112.7-1.9-74.1 0-110.8.4-112.3 1.1zM69.3 236.2c-5.7 2.8-6.7 12.2-1.7 16.9l2.6 2.4 77.9.3c86.8.3 82.6.6 85.5-6.5 1.9-4.3.5-9.3-3.3-12.3-2.5-2-3.8-2-80.7-1.9-51.9 0-78.8.4-80.3 1.1zM351 236.4c-60.7 10.8-106.5 58-115.1 118.5-1.5 10.6-.7 36.1 1.5 46.1 5.8 26.5 17.9 49.2 36.7 68.5 20.1 20.7 43.1 33.4 71.7 39.7 14.5 3.2 40.7 3.2 55.1 0 28.5-6.4 50.2-18.2 70.2-38.1 19.9-20 31.7-41.7 38.1-70.2 3.2-14.4 3.2-40.6 0-55.1-3-13.7-6.6-23.7-12.7-35.6-7.4-14.3-15.1-24.5-27-36.1-19.1-18.6-41.5-30.7-68-36.6-9.7-2.2-40.5-2.9-50.5-1.1zm48 22.5c42.9 9.8 77.1 43.1 88 85.7 10.2 39.6-1.7 82.2-30.9 111.5-40.3 40.3-101.8 45.8-149.6 13.5-14.1-9.5-30.2-28.1-38.4-44.3-9.6-19.2-13.9-44.2-11.1-65.9 6.5-52 46.3-93.5 97.8-101.9 11.5-1.9 32.8-1.2 44.2 1.4z"/>
          <path d="m366.3 301.4-2.8 2.4-.5 29.4-.5 29.3-29.3.5-29.4.5-2.4 2.8c-4.1 4.8-2.9 12.8 2.6 16 2.4 1.5 6.5 1.7 30.9 1.7H363v28c0 18.4.4 28.7 1.1 30.4 2.8 6 12.2 7.1 17 2l2.4-2.6.3-28.8.3-28.9 28.9-.3 28.8-.3 2.6-2.4c5.1-4.8 4-14.2-2-17-1.7-.7-12-1.1-30.4-1.1h-28v-28.1c0-24.4-.2-28.5-1.7-30.9-3.2-5.5-11.2-6.7-16-2.6zM69.3 300.2c-5.7 2.8-6.7 12.2-1.7 16.9l2.6 2.4h115.6l2.6-2.4c5.1-4.8 4-14.2-2-17-3.3-1.5-113.9-1.4-117.1.1z"/>
        </svg>
        <span class="open-sans" style="color:#fff;"> Ajouter.</span>
      </div>
    </div>
  </div>
  <br />
	<a id="fermer-choisir-analyse" class="expanded button open-sans" data-close aria-label="Close reveal" type="button">Fermer</a>
	<a class="close-button" data-close aria-label="Close reveal">&#215;</a>
</div>

<br /><br />
{# Chargement de la section footer #}
{{ include('footer.html.twig') }}
{# Chargement du code javascript #}
{% block javascripts %}
  {{ encore_entry_script_tags('dash') }}
{% endblock %}
</body>
</html>
